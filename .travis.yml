language: bash
dist: bionic
services:
  - docker
before_script:
  - docker --version
  - pip install --user awscli
  - export PATH=$PATH:$HOME/.local/bin
script:
  - make clean build
after_success:
  - |
    if [[ ("$TRAVIS_BRANCH" == "master") && ("$TRAVIS_EVENT_TYPE" == "push") ]]; then
      make publish docker
    else
      echo "PR build succeeded, but not publishing!"
    fi
notifications:
  slack: form3:SLG0PifAeMC7xowWEt2rjFZn
env:
  global:
    - secure: iq+YD4ClRkdtSbnH2i93wwLYnmnl3FW/ZFdmOWTPuvFiDYR0xzBIJFs9uue4mCNmV98Nl0WT/0gaaPqRgIe2BBKZD1LE9xVbPdUCA2xLO+AHjqrMhlVMBTUCn3ZOAIqPFc+2CiUnTFTyd8uFJCND1Hb6voYqXe+9mfd3ybMZxLmKT2LINbHDX3uL8TJ7XY/lofcJhHUqes1mteWuooOxXgE3Hzyv84gSERcotAT9KnmJdJteKbkjgD+eFP3RPn+xoyGZ/iVKFIn+l3/kELibHI7KqkzOQUDpd+kzD/ug3RGPSnwJvLoLuceBFPdGpzuur6ONh3umzwgpL70+lBnz5F/JL0Mc+rqcHipaplmahCKA40kXn/2HlkGPVDly7ZQmvy1O7ehI/jeHon0srPhVkFct1ba/Ec6YGvkvOML60+dnK729izF+jgvMGio6+sKeIqCvIiI3OOxwuVce1dy25YYevjSxprLyGbUEGG8C+VDtlQOYmQcFsBdknOrqUkQEPu6FLDSd07Rzlp7t057aSyiP6nFkQIsms5An9+FhFH2IlbW/8d4+uOsVT7DV3jyGG+l34GskGHRaWwhs1/+BIS+2cA723d/jQy8LF7S1S08oA6vgp0XBXo1zA/7XypcmVKz7W4SUjKEsjbRzJLGFHg8/qA/X88PQ83qYpsi+AhU=
    - secure: nx9sRLj8vH4e3YAVKX8rvacIwykHjBh9rfUbM0ddqB3MXYX9FFdjdQpX4ImHFfpKPH7jtRvz0Xp3rwiiUKQFORl1b6gv/6Hs1et6Z6nhKvUx7P5LX2cCrNf4T3pe3st2NgK7ptcYCVovroFPYel/jszglOaCxEiljfEVICq/gSBo3polFy7D23N/jByoboR821q6uCc305VngSNSLaGqm4m4e3tWBZSBpsGTqd0JpJaNwXfbEl56jOOy3WIS68Bn5QVFg2dxzmeu6xf7FM5eXBedJDIwohgQ90E/ydbGWJMHZBHc/96Q3CkTNC3M3WA9b0Xyzkfk1gmLBWwui67us18Ly3sPYiwplg5pmmm4RrAQA/0LCaGViMwyRomms14Vz83xL5EkA/vk4tMlS/o9Q3SoDWLVrIhJr5Y6CZGuI/ySpGPPihX6pKU464jYN0kouCZRwbsXCiKGwTWlAkCNKRGaz0xitAmEYAYBFF3LgoL1qIoxoE4YZJsIu1REPUa0Us2oREv61hByENmwiQ1z6eTLUKmt5TcBXxGMmyxhfKLDOP7ZOmeQ5y/voHR0bCtWMxNosC2whTxuXcEhYhpwI8rHx/Vi1x4eqU91K92UuNxvXzKQYBV8/Z+2v44R918O3+Jw2go9+ctemDy082WQnVmFNrxMCVreCQPGWUSGDHs=
    - secure: hZMbeBqrWeJ7111J//hc4yk8tdGLybjLWcu+3VDFpMEF9sAgj9PHhJBzYJoOgqh/ZYGfsWh1SBBNinFoXFibhY1qD4e35bctXDSFne9xBSuqYrCeW6pu8XcoGsWfv0Ij5mXW/ybVUq81ol4kJn+7cyNWSNFHQE9LzckGE2iqQLcp2zoH6MMJ8vvJYv+8AdiJ4Hh3dK+BYWW1SWLw4Z6krK77GrNRZoYUs8yUZd3kJ2A0by3CtMipH8vlWOb39OgkjyIy7A7rHGZtppwi2bwRayIhXxxJ4Q9ZhCFZ4FRnOB2wNtv7ovdUxscQrX/Fafyj5+YLydupYDh9vYemDM3wvscc03wMEw8NQFQ30IoIKkebqQyrHtRGsbLjJWpqycGWpchU8RXbTbCXFY6kZPZ7nJOfCQ4alDKsYGwB9F+pr7KIjPozoVqLjgeqzTPYEVa7aRuXrwENcnrWGo/ioMNLX+nOhAMdwVzhyEV2EQBR/xqVhubUNf/CVxw6msUf/ZdiS5fZIDsrMRuK72KpE3I+UE7iXDz9fAcBE8PUt/sFOxElZUr7rotI9rg3VJQxcHrUl4h2L04ANgIK+cDFqYbAk7CzBM62AzhogenyF2DHg5araiv8mS6McqtJre0FmNEcvbx+a/Gf71Itj/xRgxCKJ+yZzZq0R85djgDOGyiIW8c=
    - secure: VsV0QZdGIAvqx5JhwHkNNiraq1jx0YSWKw1RbKW0Vh1l1uppk8VSJ9yL72IweWRIEylgLKGKwtHXwFceiMws6B+7ghVj2MOVuE+GoftGt8zVLQLolu5f19HYNY6SdmL8ModJhQvA+Rr4oRlT4Z+lDEnyTIAL8VaO4bnvr5TavpLR+D4wISzBJOrfybNQP3bV03KwsHi5JNZDJ0JCAfwHzYRMtit3oBY9oXzo+MVBTOfIyF0Ou3HMDs4cBGdor6OVYvG+SJRiIci3LBUsDgUijfknJAbnv5V4M87BHqNRjPAH0TBAZEeybCnwGTM5JIpqvKLpgAYSgVsoL0UCX4HdlkoZ3I8b0RBAqu5DVWyX08+cMH028vZ8e3/Ov9xT/kiJo4f/6+/YSMWGDGOnGptj/l8d/21OXFBYZsrc8A4J9HkovYfdMpI2Daq6vsyj8qrLpIKBkGK+yJ0jVzJciX7rgrqkTM6zt9mUfTz0tmdDtiNZTXJp5IKEgi75SMDJrx/G73yu3ZcM61Oud/P/q3HueCER4n3+sZoumG0D1UISZd7p+GRz9skZ22+xEpZZZYujm6083S56M/CjD1ktgQ6cTbLspq0LIk8dIscctnba5qDtgG0UW2lF93TYUQUvSTpdag4nW+maCB8kcOKKZH8bItY089fFFd3Jb8fgpN9O/eI=
    - secure: ROKiLfmP18zFxSy6PTyUsoJcL7A0ec1LU1PIEqkYXS6FpJ3TM/5M28jPUb99RwHkZSlNmlB5BDS+4bv4mntJWqBfRnR8Zx6xNTntR+NEl30qX78TwVhReqBQ3TkiyFObZqSb/bsT1Rg5jVIU/mzzLf806gSqad28+I2rZf5EpQqvMxQvfyA2G3NetzC+V//sRRHK9AAwjNa/VZoENepyZp6Nd8PLXk5nHe2GIN2XSiFNhdRB+Is+FFMopTW4egWi5z8R+7nyt7OxV3yUzhUQBw/QuzyeLUF4xxpYgT9XNhrG5TGZbzCfxsKw5A0gzwGy/BdbjANb1KLbDaTBI/fR/oDJA2gyu8Wq3Wbef+S9zw2H3MX6ucyC/MmI5tcyOIwreq3heWJ/DebDusOrFy+9yzujIb8zCsNu+SWoACVau907p7a64ck8aKujcBqU38ladCNIAF1rZAYrxqRRCH646NWSIjFMP+HZhWcdFmMIjpNF/mAjj1TXskSRoCSSL1NyvlchdWRGj5MzCiwsCdv7X32TLb6M008KxiJxki5h1SDMmFlCXzmrYKjfeZoAwisyY0s9k3Rr+eszIrtG27YCbUgKOoA8jZB/FPDbhZ870Mw49sfb0nphMqyVzdyPzbPBfUIp383QjpnvmZvkFgx5wB7nxM1D/RbpI+y4Easj1Ck=
    - secure: RL5SINLUCJC9jctGj6UBqfyK9+m4gNZbobi/oe4lClBzwOknQ7UCPTwvx/+1sUjSVjvnX9R/t+rBNwHscnlp+aj7NelQZMBJj1Rm5IEjk1nedpi4fcAY15g0Q/NFo5eEeXUcJomC1eMSYFmmQ9QsUMBuWX7CnK6W1RPtBvqN7xwZAjJpoy1pkPFX4LvTiXFsbPdJiwXqJ+rW814cZzltkoj+31heQZ+/qprn0XI/WKs1hN6/0kB35RkMR1QSd7VyXwDZyJ4/w9e2QLfvvKTTayqdZ9cGXSglCdFioqDl+plvYtLdXrQJ7iTjwxVQi6q1fFDFSfRAJO73d85e2hvtAXLcqlqp+MSbfIOcCYSgM5649A0uinwKHZijXEb3SMqV6xi6K24PGrar79fHRbH4PCfOMnVefxStJkNO69oAzPhASf/Fv4I1dmqvKMnH13QBPXkTbkroN3VjUJft2t49s2AiE74mt7WVe/lbkjR2v/aOQ5lRvaKoABACSqYW5iZEBR55lJC0w7H8Bf6MuWBU/1EFwqNUSCwXv3XWKuz5z954a/mkm7GjYKh15vE0SE95NrrJyRmUqkbYS87ewoRm3lb+EPdApo8tjiXlOWyzXBp0en3lIAw0AKczeEc9RyIXFCtwzCrRyGVhIGeDKilo5cuKurL8MLLKZK4gRjViCFg=
    - secure: KcMdIqxX6MoyxtnCE1HaVbQ/9yWgwS1oSlHkZuow1QAsYvqpl9fdt0G1xcGGDonigpB2ln3VsY5kkjU4Yk4KJgmqfsTB3bTlv+fWtXOILn6eGsIvUrM++0IeiymY1RGo6aFyRI2QnEf1rPWBnLTCbhEkzS1BXn1iNrHRtPGW1szqItPFO2uREvZGWXtmREkXg84DiVLOnZizJpB9G/btL9/8KG9x21aYsuB9WZ1fnAoUwr4cvYg4ojoy6QpPIVO0n/x4M6BCzjZLHhx5JodKPqtMt7oyq5TgkONCKsRfir0KDZ0f1OoIwOZ3LJQLvyEFn9RLgu6GPBw6LaiSdb/7rdRpTEG35DILdzAZVMGBr/MyOA57lblDrmCZs9zPwWk7iVlGc3KwzEZ5/YKYxUZoQhnD3saldbvIr40j2grHB88l//kj1+xEX9AKHZYEvt2vbA4R07NU/VSRvspTcgefmAumHfh4HQANa3tniOeBnAyPRTSYKHvq2a6YGddi2s6kXRNUoQ/yR+cGxePZElxcXfnQaPFhDuQlkbCHhFyKIxt/nEO3u8J4yYbtXW0KtamCrhk+XBea68RF8+e0S/e9UwVcVts8wb87EZuUydWjzbErsxrdA2XOREamRHy+isM3YVSmynkO+/WUWSgDIcWkn5O32RIwgI5KmzpeNB1lulQ=
  matrix:
    - TERRAFORM_VERSION=0.11.15
    - TERRAFORM_VERSION=0.12.31
    - TERRAFORM_VERSION=0.13.7
    - TERRAFORM_VERSION=0.14.11
    - TERRAFORM_VERSION=0.15.1
